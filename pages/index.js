import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'
import {Box} from '@chakra-ui/react'
import { AllPosts,PostsByTopic} from '../utils/db'
import {useState,useEffect} from 'react'
import {useRouter} from 'next/router'
import VideoCard from '../components/video/videoCard'
export default function Home() {

const [posts, setPosts] = useState([]);

// current query
const router = useRouter();
const { topic } = router.query;
console.log('ðŸŒŸðŸŒŸðŸŒŸ--->',topic);


useEffect(() => {

if (topic) {

  PostsByTopic(topic).then(posts => {
    setPosts(posts);
  }).catch(err => {
    console.log(err);
  }).finally(() => {
    console.log('finally');
  }
  )
}

if (topic ===  undefined  || topic === null) {


  AllPosts().then(res => {
    setPosts(res)
    console.log('res------>',res)
  } )

}
}, [topic])



  return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
<div>

 
  <div>


<div>

{/* //----make map to all posts and display them */}

{posts.map(post => {

return (
<div key={post.id}>
<VideoCard homepage={true} post={post}/>
</div>

)})}


</div>





  </div>



 

 



</div>


    </div>
  )
}
